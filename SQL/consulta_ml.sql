CREATE OR REPLACE TABLE enem.base_completa AS
SELECT 
  farm_fingerprint(GENERATE_UUID()) AS HASHID,
  t.NU_ANO,
  t.TP_PRESENCA_MT,
  t.NU_NOTA_MT,
  t.Q001, t.Q002, t.Q003, t.Q004, t.Q005, t.Q006, t.Q007, t.Q008, t.Q009, t.Q010,
  t.Q011, t.Q012, t.Q013, t.Q014, t.Q015, t.Q016, t.Q017, t.Q018, t.Q019, t.Q020,
  t.Q021, t.Q022, t.Q023, t.Q024, t.Q025, t.Q026, t.Q027,
  t.TP_ESTADO_CIVIL, t.TP_COR_RACA, t.TP_ESCOLA, t.CO_UF_PROVA,
  CAST(NULL AS INT64) AS IN_TEMPO_ADICIONAL,
  CAST(NULL AS INT64) AS TP_FAIXA_ETARIA
FROM `dynamic-camp-468900-t5.enem.enem_2018` AS t
WHERE t.TP_PRESENCA_MT = 1 AND t.NU_NOTA_MT IS NOT NULL